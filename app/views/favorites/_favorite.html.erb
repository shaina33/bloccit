<% if favorite = current_user.favorite_for(post) %>
<!-- assigns the favorite if it exists. if it doesn't, nil will not execute the if -->
    <%= link_to [post,favorite], class: 'btn btn-danger', method: :delete do %>
        <i class="glyphicon glyphicon-star-empty"></i>&nbsp; Unfavorite
    <% end %>
<% else %>
    <%= link_to [post, Favorite.new], class: 'btn btn-primary', method: :post do %>
        <i class="glyphicon glyphicon-star"></i>&nbsp; Favorite
    <% end %>
<% end %>